{"version":3,"file":"insight.store-1d26f990.js","sources":["../src/env.ts","../../../node_modules/.pnpm/@rollup+plugin-typescript@11.1.6_rollup@2.79.1_tslib@2.5.3_typescript@5.1.3/node_modules/tslib/tslib.es6.js","../src/utility/fetch.ts","../src/utility/error.ts","../src/api/api.ts","../src/stores/insight/insight.store.ts"],"sourcesContent":["/**\n * Singleton variable holding environment information\n */\nexport class Env {\n    /**\n     * Variables that are loaded into the enviornment\n     */\n    private static _store = {\n        APP: \"\",\n        MODULE: \"\",\n        ACCESS_KEY: \"\",\n        SECRET_KEY: \"\",\n    };\n\n    /**\n     * Get the APP ID\n     */\n    static get APP() {\n        return this._store.APP;\n    }\n\n    /**\n     * Ready only getter\n     */\n    static get MODULE() {\n        return this._store.MODULE;\n    }\n\n    /**\n     * Ready only getter\n     */\n    static get ACCESS_KEY() {\n        return this._store.ACCESS_KEY;\n    }\n\n    /**\n     * Ready only getter\n     */\n    static get SECRET_KEY() {\n        return this._store.SECRET_KEY;\n    }\n\n    /**\n     *\n     * @param updated - updated variables\n     */\n    static update = (updated: Partial<(typeof Env)[\"_store\"]> = {}) => {\n        if (updated.hasOwnProperty(\"APP\")) {\n            this._store.APP = updated.APP;\n        }\n\n        if (updated.hasOwnProperty(\"MODULE\")) {\n            this._store.MODULE = updated.MODULE;\n        }\n\n        if (updated.hasOwnProperty(\"ACCESS_KEY\")) {\n            this._store.ACCESS_KEY = updated.ACCESS_KEY;\n        }\n\n        if (updated.hasOwnProperty(\"SECRET_KEY\")) {\n            this._store.SECRET_KEY = updated.SECRET_KEY;\n        }\n    };\n}\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport default {\r\n    __extends,\r\n    __assign,\r\n    __rest,\r\n    __decorate,\r\n    __param,\r\n    __metadata,\r\n    __awaiter,\r\n    __generator,\r\n    __createBinding,\r\n    __exportStar,\r\n    __values,\r\n    __read,\r\n    __spread,\r\n    __spreadArrays,\r\n    __spreadArray,\r\n    __await,\r\n    __asyncGenerator,\r\n    __asyncDelegator,\r\n    __asyncValues,\r\n    __makeTemplateObject,\r\n    __importStar,\r\n    __importDefault,\r\n    __classPrivateFieldGet,\r\n    __classPrivateFieldSet,\r\n    __classPrivateFieldIn,\r\n};\r\n","// store the interceptors\nexport const interceptors: {\n    request: ((options: RequestInit) => Promise<RequestInit>) | null;\n    response: ((output: { response: Response }) => Promise<void>) | null;\n} = {\n    request: null,\n    response: null,\n};\n\n/**\n * Make a get call to the backend\n * @param path - path\n * @param options - options to pass into the fetch\n */\nexport const get = async <O>(path: string, options: RequestInit = {}) => {\n    options = {\n        method: \"GET\",\n\n        ...options,\n    };\n\n    // intercept\n    if (interceptors.request) {\n        options = await interceptors.request(options);\n    }\n\n    // get the data\n    const response = await fetch(`${path}`, options);\n\n    // handle the response\n    if (interceptors.response) {\n        await interceptors.response({\n            response: response,\n        });\n    }\n\n    // get the data\n    const data = await response.json();\n\n    // return the json\n    return {\n        response: response,\n        data: data as O,\n    };\n};\n\n/**\n * Make a post call to the backend\n * @param path - path\n * @param body - body to pass in\n * @param options - options to pass into the fetch\n */\nexport const post = async <O>(\n    path: string,\n    body: FormData | Record<string, unknown>,\n    options: RequestInit = {},\n) => {\n    const isFormData = body instanceof FormData;\n\n    // create a new headers object or use the option\n    let headers: HeadersInit = {};\n    if (options.headers) {\n        headers = options.headers;\n    }\n\n    // add headers if not a form\n    if (!isFormData) {\n        (headers as Record<string, string>)[\"Content-Type\"] =\n            \"application/x-www-form-urlencoded\";\n    }\n\n    options = {\n        method: \"POST\",\n        headers: headers,\n        body: isFormData\n            ? body\n            : Object.keys(body)\n                  .map((k) => {\n                      let val = body[k];\n                      if (typeof val !== \"string\") {\n                          val = JSON.stringify(body[k]);\n                      }\n\n                      return `${encodeURIComponent(k)}=${encodeURIComponent(\n                          val as string,\n                      )}`;\n                  })\n                  .join(\"&\"),\n        ...options,\n    };\n\n    // intercept\n    if (interceptors.request) {\n        options = await interceptors.request(options);\n    }\n\n    // get the data\n    const response = await fetch(`${path}`, options);\n\n    // handle the response\n    if (interceptors.response) {\n        await interceptors.response({\n            response: response,\n        });\n    }\n\n    // get the data\n    const data = await response.json();\n\n    // return the json\n    return {\n        response: response,\n        data: data as O,\n    };\n};\n","/**\n * AbstractError class\n */\nclass AbstractError extends Error {\n    constructor(message: string) {\n        super(message);\n        this.name = this.constructor.name;\n    }\n}\n\n/**\n * Error thrown when a user is not authorized anymore\n */\nexport class UnauthorizedError extends AbstractError {\n    constructor(message: string) {\n        super(message);\n    }\n}\n","import { Env } from \"../env\";\nimport { get, post, interceptors, UnauthorizedError } from \"../utility\";\n\nconst CSRF = {\n    isEnabled: false,\n    token: \"\",\n};\n\n// set up the request interceptor\ninterceptors.request = async (options) => {\n    if (Env.ACCESS_KEY && Env.SECRET_KEY) {\n        // create the headeres\n        if (!options.headers) {\n            options.headers = {};\n        }\n\n        // add the authorization tokens\n        options.headers = {\n            ...options.headers,\n            authorization: `Basic ${btoa(\n                `${Env.ACCESS_KEY}:${Env.SECRET_KEY}`,\n            )}`,\n        };\n    }\n\n    // only set if enabled\n    if (CSRF.isEnabled) {\n        if (options.method === \"POST\") {\n            // use the token if it is there\n            if (!CSRF.token) {\n                const { response } = await get(\n                    `${Env.MODULE}/api/config/fetchCsrf`,\n                    {\n                        headers: {\n                            \"X-CSRF-Token\": \"fetch\",\n                        },\n                    },\n                );\n\n                // not sure why the proxy server is sending it as lowercase, preserving headers doesn't fix it\n                CSRF.token =\n                    response.headers.get(\"X-CSRF-Token\") ||\n                    response.headers.get(\"x-csrf-token\") ||\n                    \"\";\n            }\n\n            // add the token\n            if (options.headers) {\n                options.headers = {\n                    ...options.headers,\n                    \"X-CSRF-Token\": CSRF.token,\n                };\n            }\n        }\n    }\n\n    return options;\n};\n\n// setup the response interceptor\ninterceptors.response = async ({ response }) => {\n    if (response.status === 302) {\n        throw new UnauthorizedError(\"Unauthorized\");\n    }\n};\n\n/**\n * Get the System's configuration information\n */\nexport const getSystemConfig = async (): Promise<{\n    logins: { [key: string]: unknown };\n    /**\n     * List of available providers (logins) that are available\n     */\n    availableProviders: {\n        provider: string;\n        name: string;\n        isOauth: boolean;\n    }[];\n    [key: string]: unknown;\n}> => {\n    // get the response\n    const response = await get<{\n        logins: { [key: string]: unknown };\n        availableProviders: {\n            provider: string;\n            name: string;\n            isOauth: boolean;\n        }[];\n        [key: string]: unknown;\n    }>(`${Env.MODULE}/api/config`);\n\n    if (response.data && response.data.csrf) {\n        const token = response.data[\"X-CSRF-Token\"] as string;\n\n        // enable and store the token\n        CSRF.isEnabled = true;\n        CSRF.token = token;\n    }\n\n    // save the config data\n    return response.data;\n};\n\n/**\n * Run a pixel string\n *\n * @param pixel - pixel\n * @param insightId - id of the insight to run\n */\nexport const runPixel = async <O extends unknown[] | []>(\n    pixel: string,\n    insightId?: string,\n) => {\n    if (!pixel) {\n        throw new Error(\"Missing Pixel\");\n    }\n\n    const body: Record<string, unknown> = {\n        expression: pixel,\n    };\n\n    if (insightId) {\n        body.insightId = insightId;\n    }\n\n    const response = await post<{\n        insightID: string;\n        pixelReturn: {\n            isMeta: boolean;\n            operationType: string[];\n            output: O[number];\n            pixelExpression: string;\n            pixelId: string;\n            additionalOutput?: unknown;\n            timeToRun: number;\n        }[];\n    }>(`${Env.MODULE}/api/engine/runPixel`, body, {});\n\n    // collect the errors\n    const errors: string[] = [];\n    for (const p of response.data.pixelReturn) {\n        const { output, operationType } = p;\n\n        if (operationType.indexOf(\"ERROR\") > -1) {\n            errors.push(output as string);\n        }\n    }\n\n    return {\n        errors: errors,\n        insightId: response.data.insightID,\n        pixelReturn: response.data.pixelReturn,\n    };\n};\n\n/**\n * Asyncronously run a pixel string\n *\n * @param pixel - pixel\n * @param insightId - id of the insight to run\n */\nexport const runPixelAsync = async (pixel: string, insightId?: string) => {\n    if (!pixel) {\n        throw Error(\"No Pixel To Execute\");\n    }\n\n    // build the expression\n    let postData = \"\";\n\n    postData += \"expression=\" + encodeURIComponent(pixel);\n    if (insightId) {\n        postData += \"&insightId=\" + encodeURIComponent(insightId);\n    }\n\n    try {\n        const response = await fetch(`${Env.MODULE}/api/engine/runPixelAsync`, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/x-www-form-urlencoded\",\n            },\n            body: postData,\n        });\n\n        if (!response.ok) {\n            const errorData = await response.json();\n            throw Error(errorData.errorMessage || \"Failed to run pixel\");\n        }\n\n        const data = await response.json();\n\n        if (!data) {\n            throw Error(\"No Pixel Response\");\n        }\n\n        return {\n            jobId: data.jobId,\n        };\n    } catch (error) {\n        if (error instanceof Error) {\n            throw error;\n        }\n        throw Error(\"An unknown error occurred\");\n    }\n};\n\n/**\n * @name getPixelAsyncResult\n * @description Gets results for async pixel calls\n */\nexport const getPixelAsyncResult = async <O extends unknown[] | []>(\n    jobId: string,\n) => {\n    if (!jobId) {\n        throw Error(\"No job id provided to get pixel response\");\n    }\n\n    const body = new URLSearchParams();\n    body.append(\"jobId\", jobId);\n\n    try {\n        const response = await fetch(`${Env.MODULE}/api/engine/result`, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/x-www-form-urlencoded\",\n            },\n            body: body,\n        });\n\n        if (!response.ok) {\n            const errorData = await response.json();\n            throw Error(\n                errorData.errorMessage || \"Failed to get pixel response\",\n            );\n        }\n\n        const data = (await response.json()) as {\n            insightID: string;\n            pixelReturn: {\n                operationType: string[];\n                output: unknown;\n                pixelExpression: string;\n            }[];\n        };\n\n        // there was no response, that is an error\n        if (!data) {\n            throw Error(\"No Pixel Response\");\n        }\n\n        const errors: string[] = [];\n\n        // collect the errors\n        for (const p of data.pixelReturn) {\n            const { output, operationType } = p;\n\n            if (operationType.indexOf(\"ERROR\") > -1) {\n                errors.push(output as string);\n            }\n        }\n\n        return {\n            errors: errors,\n            insightId: data.insightID,\n            results: data.pixelReturn,\n        };\n    } catch (error) {\n        if (error instanceof Error) {\n            throw error;\n        }\n        throw Error(\"An unknown error occurred\");\n    }\n};\n\n/**\n * Allow the user to login\n *\n * @param username - username to login with\n * @param password - password to login with\n * @returns true if successful\n */\nexport const login = async (\n    username: string,\n    password: string,\n): Promise<boolean> => {\n    await post(`${Env.MODULE}/api/auth/login`, {\n        username: username,\n        password: password,\n        disableRedirect: true,\n    });\n\n    return true;\n};\n\n/**\n * Allow the user to login with outh\n *\n * @param provider - provider to login with\n * @param isPopup - check if in popup\n * @returns true if successful\n */\nexport const oauth = async (\n    provider: string,\n    isPopup = false,\n): Promise<boolean> => {\n    // check if the user is logged in\n    const response = await get<{ name?: string }>(\n        `${Env.MODULE}/api/auth/userinfo/${provider}`,\n    );\n\n    //check if they are already logged in\n    if (response.data && response.data.name) {\n        return true;\n    }\n\n    // if called from the popup, throw an error as the user was unable to login\n    if (isPopup) {\n        throw new Error(\"Unable to login\");\n    }\n\n    return new Promise((resolve, reject) => {\n        if (!window || !window.top) {\n            reject(\"Unable to login\");\n            return;\n        }\n\n        const url = `${Env.MODULE}/api/auth/login/${provider}`;\n        const popUpWindow = window.top.open(\n            url,\n            \"_blank\",\n            \"height=600,width=400,top=300,left=\" + 600,\n        );\n\n        // setup an interval to see if the popup window is closed or successful\n        const interval = setInterval(async () => {\n            try {\n                if (\n                    !popUpWindow ||\n                    popUpWindow.closed ||\n                    popUpWindow.closed === undefined\n                ) {\n                    clearInterval(interval);\n                } else if (\n                    popUpWindow.document.location.href.indexOf(\n                        `${window.location.host}`,\n                    ) > -1\n                ) {\n                    clearInterval(interval);\n\n                    // close it\n                    popUpWindow.close();\n\n                    // try to get the info again\n                    const response = await oauth(provider, true);\n\n                    // close it\n                    resolve(response);\n                }\n            } catch (err) {\n                // do nothing\n                // this is to work around the blocked frame error that comes up\n            }\n        }, 1000);\n    });\n};\n\n/**\n * Allow the user to logout\n *\n * @returns true if successful\n */\nexport const logout = async (): Promise<boolean> => {\n    // try to logout\n    await get(`${Env.MODULE}/api/auth/logout/all`);\n\n    return true;\n};\n\n/**\n * Upload file(s) to the backend\n * @param files\n * @param insightId\n * @param projectId\n * @param path\n * @returns\n */\nexport const upload = async (\n    files: File | File[],\n    insightId: string | null,\n    projectId: string | null,\n    path: string,\n): Promise<\n    {\n        fileName: string;\n        fileLocation: string;\n    }[]\n> => {\n    let param = \"\";\n\n    path = path || \"\";\n    if (insightId || projectId || path) {\n        if (insightId) {\n            if (param.length > 0) {\n                param += \"&\";\n            }\n            param += `insightId=${insightId}`;\n        }\n\n        if (projectId) {\n            if (param.length > 0) {\n                param += \"&\";\n            }\n            param += `projectId=${projectId}`;\n        }\n\n        if (path) {\n            if (param.length > 0) {\n                param += \"&\";\n            }\n            param += `path=${path}`;\n        }\n\n        param = `?${param}`;\n    }\n\n    const url = `${Env.MODULE}/api/uploadFile/baseUpload${param}`;\n\n    const fd: FormData = new FormData();\n    if (Array.isArray(files)) {\n        for (let i = 0; i < files.length; i++) {\n            fd.append(\"file\", files[i]);\n        }\n    } else {\n        // pasted data\n        fd.append(\"file\", files);\n    }\n\n    const response = await post<\n        {\n            fileName: string;\n            fileLocation: string;\n        }[]\n    >(url, fd, {});\n\n    return response.data;\n};\n\n/**\n * Download a file by using a unique key\n *\n * @param insightId - insightId to download the file\n * @param fileKey - id for the file to download\n */\nexport const download = async (insightId: string, fileKey: string) => {\n    return new Promise<void>((resolve) => {\n        if (!insightId) {\n            throw Error(\"No Insight ID provided for download.\");\n        }\n        // create the download url\n        const url = `${\n            Env.MODULE\n        }/api/engine/downloadFile?insightId=${insightId}&fileKey=${encodeURIComponent(\n            fileKey,\n        )}`;\n\n        // fake clicking a link\n        const link: HTMLAnchorElement = document.createElement(\"a\");\n\n        link.href = url;\n        link.target = \"_blank\";\n        document.body.appendChild(link);\n        link.click();\n\n        document.body.removeChild(link);\n\n        // resolve the promise\n        resolve();\n    });\n};\n\n/**\n * Get a partial result from the insight\n * @param insightId - id of the insight to run\n */\nexport const partial = async (insightId: string) => {\n    const response = await post<{\n        message: {\n            new: string;\n            total: string;\n        };\n        status: string;\n    }>(`${Env.MODULE}/api/engine/partial`, {\n        jobId: insightId,\n    });\n\n    return response.data;\n};\n\n/**\n * Get the console message from an insight\n * @param insightId - id of the insight to run\n */\nexport const console = async (insightId: string) => {\n    const response = await post<{\n        message: string[];\n        status: string;\n    }>(`${Env.MODULE}/api/engine/console`, {\n        jobId: insightId,\n    });\n\n    return response.data;\n};\n\n/**\n * Get the console message from an insight\n * @param insightId - id of the insight to run\n */\nexport const getPixelConsole = async (insightId: string) => {\n    const response = await post<{\n        message: string[];\n        status: string;\n    }>(`${Env.MODULE}/api/engine/console`, {\n        jobId: insightId,\n    });\n\n    return response.data;\n};\n","import { Env } from \"../../env\";\nimport { Space, Script } from \"../../types\";\nimport {\n    getSystemConfig,\n    login,\n    logout,\n    oauth,\n    runPixel,\n    upload,\n    download,\n} from \"../../api\";\nimport { UnauthorizedError } from \"../../utility\";\n\ninterface InsightStoreInterface {\n    /** insightId of the app */\n    insightId: string;\n\n    /** Track if the insight is loaded */\n    isInitialized: boolean;\n\n    /** Track if the user is authorized */\n    isAuthorized: boolean;\n\n    /** Track if the insight is ready for user input */\n    isReady: boolean;\n\n    /** Error if in the error state */\n    error: Error | null;\n\n    /** System Information */\n    system: {\n        /** Config information */\n        config: {\n            logins: Record<string, unknown>;\n            /**\n             * List of available providers (logins) that are available\n             */\n            availableProviders: {\n                provider: string;\n                name: string;\n                isOauth: boolean;\n            }[];\n            [key: string]: unknown;\n        };\n    } | null;\n\n    /** Options assocaited with the insight */\n    options: {\n        /** Id of an app if associated with the insight */\n        appId: string;\n\n        /** Python code associated with the insight */\n        python: Script | null;\n    };\n}\n\nexport class InsightStore {\n    private _store: InsightStoreInterface = {\n        insightId: \"\",\n        isInitialized: false,\n        isAuthorized: false,\n        isReady: false,\n        error: null,\n        system: null,\n        options: {\n            appId: \"\",\n            python: null,\n        },\n    };\n\n    /** Getters */\n    /**\n     * Insight Id\n     */\n    get insightId() {\n        return this._store.insightId;\n    }\n    /**\n     * If the insight is initialied\n     */\n    get isInitialized() {\n        return this._store.isInitialized;\n    }\n\n    /**\n     * If the user is authorized\n     */\n    get isAuthorized() {\n        return this._store.isAuthorized;\n    }\n\n    /**\n     * Track if the insight is ready for user input\n     */\n    get isReady() {\n        return this._store.isReady;\n    }\n    /**\n     * Error if the status is set to \"ERROR\"\n     */\n    get error() {\n        return this._store.error;\n    }\n\n    /**\n     * System information\n     */\n    get system() {\n        return this._store.system;\n    }\n\n    /** Methods */\n    /**\n     * Initialize the insight\n     *\n     * options - options to initialize with\n     */\n    initialize = async (options?: {\n        /**\n         * App to load into the insight\n         */\n        app?: string | false;\n\n        /**\n         * Python file to load into an insight\n         */\n        python?:\n            | {\n                  type: \"detect\";\n              }\n            | {\n                  type: \"file\";\n                  path: string;\n                  alias: string;\n              }\n            | {\n                  type: \"script\";\n                  script: string;\n                  alias: string;\n              }\n            | false;\n    }): Promise<void> => {\n        // reset it\n        this._store.isInitialized = false;\n        this._store.isAuthorized = false;\n        this._store.isReady = false;\n\n        const merged: NonNullable<typeof options> = {\n            app: options && options.app ? options.app : \"\",\n            python:\n                options && typeof options.python !== \"undefined\"\n                    ? options.python\n                    : {\n                          type: \"detect\",\n                      },\n        };\n\n        // save the initial appId\n        this._store.options.appId = \"\";\n        if (merged.app) {\n            this._store.options.appId = merged.app;\n        }\n\n        // save the python\n        this._store.options.python = null;\n        if (merged.python) {\n            if (merged.python.type === \"detect\") {\n                this._store.options.python = await this.detectScript();\n            } else if (merged.python.type === \"file\") {\n                this._store.options.python = await this.loadScript(\n                    merged.python,\n                );\n            } else if (merged.python.type === \"script\") {\n                this._store.options.python = {\n                    script: merged.python.script,\n                    alias: merged.python.alias,\n                };\n            }\n        }\n\n        // load the environment from the document (production)\n        try {\n            if (!document) {\n                return;\n            }\n\n            const env = JSON.parse(\n                document.getElementById(\"semoss-env\")?.textContent || \"\",\n            ) as {\n                APP: string;\n                MODULE: string;\n            };\n\n            // update the enviornment variables with the module\n            if (env) {\n                Env.update({\n                    APP: env.APP,\n                    MODULE: env.MODULE,\n                });\n            }\n        } catch (e) {\n            // noop\n        }\n\n        try {\n            // reset the id based on the Environment if set\n            if (Env.APP) {\n                this._store.options.appId = Env.APP;\n            }\n\n            // validate that the module is available\n            if (!Env.MODULE) {\n                throw new Error(\"module is required\");\n            }\n\n            // get the system information\n            await this.setupSystem();\n\n            // break if no system\n            if (!this._store.isInitialized) {\n                throw new Error(\"Error loading system\");\n            }\n\n            // if security is not enabled or the user is logged in, load the app\n            if (\n                (this._store.system &&\n                    Object.keys(this._store.system.config.logins).length > 0) ||\n                (Env.ACCESS_KEY && Env.SECRET_KEY)\n            ) {\n                // track that the user is authorized\n                this._store.isAuthorized = true;\n\n                // setup the insight\n                await this.setupInsight();\n            } else {\n                // track that the user is unauthorized\n                this._store.isAuthorized = false;\n            }\n        } catch (error) {\n            // log it\n            console.warn(error);\n\n            // store the error\n            this._store.error = error as Error;\n        }\n    };\n\n    /**\n     * Destroy the insight\n     */\n    destroy = async () => {\n        try {\n            // destroy the insight\n            await this.destroyInsight();\n\n            // destroy the system\n            this.destroySystem();\n        } catch (error) {\n            // log it\n            console.warn(error);\n\n            // store the error\n            this._store.error = error as Error;\n        } finally {\n            // reset it\n            this._store.isInitialized = false;\n            this._store.isAuthorized = false;\n            this._store.isReady = false;\n        }\n    };\n\n    /** Helpers */\n    /**\n     * Initialize the system wide information\n     */\n    private setupSystem = async (): Promise<void> => {\n        // reset it\n        this._store.isInitialized = false;\n\n        // get the response\n        const data = await getSystemConfig();\n\n        let system: InsightStoreInterface[\"system\"] = null;\n        if (data) {\n            // create the system\n            system = {\n                config: {\n                    logins: {},\n                    availableProviders: [],\n                },\n            };\n\n            // save the other config data\n            for (const key in data) {\n                system.config[key] = data[key];\n            }\n        }\n\n        this._store.system = system;\n        if (this._store.system) {\n            this._store.isInitialized = true;\n        } else {\n            this._store.isInitialized = false;\n        }\n    };\n\n    /**\n     * Initialize the system wide information\n     */\n    private destroySystem = () => {\n        // clear the system\n        this._store.system = null;\n    };\n\n    /**\n     * Setup the insight after login\n     */\n    private setupInsight = async (): Promise<void> => {\n        // set as not ready\n        this._store.isReady = false;\n\n        // load the app reactors (if they exist)\n        let pixel = \"\";\n        if (this._store.options.appId) {\n            pixel += `SetContext(\"${this._store.options.appId}\");`;\n        }\n\n        // load the python code int\n        if (this._store.options.python && this._store.options.python.script) {\n            // validate the alias\n            let alias = this._store.options.python.alias;\n            if (!alias) {\n                alias = \"smss\";\n                console.warn(`Alias not found. Loading python as ${alias}`);\n            }\n\n            pixel += `\nWriteObjectToFile(value=\"${this._store.options.python.script}\", filePath = \"temp.py\");\nLoadPyFromFile(alias=\"${alias}\", filePath=\"temp.py\");    \n            `;\n        }\n\n        // default if there is no command to preload\n        if (!pixel) {\n            pixel = \"1+1;\";\n        }\n\n        // create the new insight\n        const { insightId, errors } = await runPixel<[Record<string, unknown>]>(\n            pixel,\n            \"new\",\n        );\n\n        // log errors if it exists\n        if (errors.length) {\n            throw new Error(errors[0]);\n        }\n\n        // set the insight ID\n        this._store.insightId = insightId;\n\n        // set as ready\n        this._store.isReady = true;\n    };\n\n    /**\n     * Destroy the insight\n     */\n    private destroyInsight = async (): Promise<void> => {\n        if (!this._store.insightId) {\n            return;\n        }\n\n        const { errors } = await runPixel<[Record<string, unknown>]>(\n            `DropInsight()`,\n            this._store.insightId,\n        );\n\n        // log errors if it exists\n        if (errors.length) {\n            throw new Error(errors[0]);\n        }\n\n        // set the insight ID\n        this._store.insightId = \"\";\n    };\n\n    /**\n     * Process and error in action\n     * @param error - error to process\n     */\n    private processActionError = (error: Error) => {\n        // ignore 302 errors\n        if (error instanceof UnauthorizedError) {\n            this._store.isAuthorized = false;\n            return;\n        }\n\n        // propagate it forward\n        throw error;\n    };\n\n    /**\n     * Detect a script from the html\n     */\n    private detectScript = async (): Promise<Script | null> => {\n        const output = {\n            script: \"\",\n            alias: \"\",\n        };\n\n        try {\n            const scriptEle = document.querySelector(\"[data-semoss-py]\");\n            const content = scriptEle?.textContent;\n            if (!content) {\n                return null;\n            }\n\n            // get the script\n            output.script = content;\n\n            // get the alias\n            output.alias = scriptEle?.getAttribute(\"data-alias\") || \"\";\n        } catch (e) {\n            console.warn(e);\n            return null;\n        }\n\n        return output;\n    };\n\n    /**\n     * Load an external script\n     */\n    private loadScript = async (config: {\n        path: string;\n        alias: string;\n    }): Promise<Script | null> => {\n        const output = {\n            script: \"\",\n            alias: config.alias,\n        };\n        try {\n            // get the script\n            const response = await fetch(config.path);\n\n            const text = await response.text();\n            if (!text) {\n                throw new Error(\"No Text\");\n            }\n\n            // set the text if it exists\n            output.script = text;\n        } catch (e) {\n            console.warn(e);\n\n            // don't load anything\n            return null;\n        }\n\n        return output;\n    };\n\n    /**\n     * Get the id of the space\n     * @param space - where to get it\n     * @returns id of the space\n     */\n    private getSpaceId(space: Space) {\n        let id = \"\";\n        if (space === \"insight\") {\n            id = this._store.insightId;\n        } else if (space === \"app\") {\n            if (!this._store.options.appId) {\n                throw new Error(\"An app is required to run in the app space\");\n            }\n\n            // set it\n            id = this._store.options.appId;\n        }\n\n        return id;\n    }\n\n    /** Actions */\n    /** Accessible by the end user */\n    actions = {\n        /**\n         * Allow the user to login\n         * @param credentials\n         * @returns\n         */\n        login: async (\n            credentials:\n                | {\n                      type: \"native\";\n                      username: string;\n                      password: string;\n                  }\n                | {\n                      type: \"oauth\";\n                      provider: string;\n                  },\n        ): Promise<boolean> => {\n            // try to login\n            try {\n                let loggedIn = false;\n                if (credentials.type === \"native\") {\n                    const response = await login(\n                        credentials.username,\n                        credentials.password,\n                    );\n\n                    if (response) {\n                        loggedIn = true;\n                    }\n                } else if (credentials.type === \"oauth\") {\n                    const response = await oauth(credentials.provider);\n                    if (response) {\n                        loggedIn = true;\n                    }\n                }\n\n                if (loggedIn) {\n                    // track that the user is now authorized\n                    this._store.isAuthorized = true;\n\n                    // get the new insight with the new user\n                    await this.setupInsight();\n                } else {\n                    // track that the user is unauthorized\n                    this._store.isAuthorized = false;\n                }\n\n                // success\n                return loggedIn;\n            } catch (error) {\n                this.processActionError(error as Error);\n            }\n\n            return false;\n        },\n\n        /**\n         * Allow the user to logout\n         */\n        logout: async (): Promise<boolean> => {\n            try {\n                const response = await logout();\n                if (!response) {\n                    return false;\n                }\n\n                // success\n                return true;\n            } catch (error) {\n                this.processActionError(error as Error);\n            }\n\n            return false;\n        },\n\n        /**\n         * Run a pixel against the insight\n         * @param pixel - pixel command to run\n         * @param space - where to run it\n         */\n        run: async <O extends unknown[] | []>(\n            pixel: string,\n            space: Space = \"insight\",\n        ) => {\n            try {\n                let id = \"\";\n                if (space === \"insight\") {\n                    id = this._store.insightId;\n                } else if (space === \"app\") {\n                    if (!this._store.options.appId) {\n                        throw new Error(\n                            \"An app is required to run in the app space\",\n                        );\n                    }\n\n                    // set it\n                    id = this._store.options.appId;\n                }\n\n                const { errors, pixelReturn } = await runPixel<O>(pixel, id);\n\n                if (errors.length) {\n                    throw new Error(errors.join(\"\"));\n                }\n\n                return { pixelReturn };\n            } catch (error) {\n                this.processActionError(error as Error);\n            }\n\n            // throw an error\n            throw new Error(\"No response\");\n        },\n\n        /**\n         * Run a pixel against the insight\n         * @param pixel - pixel command to run\n         * @param space - where to run it\n         */\n        runPy: async <O>(python: string, space: Space = \"insight\") => {\n            const { pixelReturn } = await this.actions.run<\n                [\n                    [\n                        {\n                            output: O;\n                        },\n                    ],\n                ]\n            >(`Py(\"<encode>${python}</encode>\")`, space);\n\n            return {\n                output: pixelReturn[0].output[0].output,\n            };\n        },\n\n        /**\n         * Ask a model a question\n         * @param engineId - engine to ask\n         * @param command - command to ask\n         * @param space - where to run it\n         */\n        askModel: async (\n            engineId: string,\n            command: string,\n            space: Space = \"insight\",\n        ) => {\n            const { pixelReturn } = await this.actions.run<\n                [{ response: string }]\n            >(\n                `LLM(engine=[\"${engineId}\"], command=[\"<encode>${command}</encode>\"]);`,\n                space,\n            );\n\n            return {\n                output: pixelReturn[0].output,\n            };\n        },\n\n        /**\n         * Query a database\n         * @param databaseId - database to query\n         * @param query - command to query\n         * @param options - options to query with\n         * @param space - where to run it\n         */\n        queryDatabase: async (\n            databaseId: string,\n            query: string,\n            options: {\n                collect: number;\n            } = {\n                collect: -1,\n            },\n            space: Space = \"insight\",\n        ) => {\n            const { pixelReturn } = await this.actions.run<\n                [\n                    data: {\n                        values: unknown[][];\n                        headers: string[];\n                    },\n                    numCollected: number,\n                    taskId: string,\n                ]\n            >(\n                `Database(database=[\"${databaseId}\"]) | Query(\"<encode>${query}</encode>\") | Collect(${\n                    typeof options.collect === \"number\" ? options.collect : -1\n                });;`,\n                space,\n            );\n\n            return {\n                output: pixelReturn[0].output,\n            };\n        },\n\n        /**\n         * Upload a file to the project space\n         *\n         * @param files- file objects to upload\n         * @param path - relative path\n         * @param space - where to run it\n         */\n        upload: async (\n            files: File | File[],\n            path: string,\n            space: Space = \"insight\",\n        ): Promise<\n            {\n                fileName: string;\n                fileLocation: string;\n            }[]\n        > => {\n            try {\n                const response = await upload(\n                    files,\n                    this._store.insightId,\n                    space === \"app\" ? this._store.options.appId : \"\",\n                    path,\n                );\n\n                return response;\n            } catch (error) {\n                this.processActionError(error as Error);\n            }\n\n            // throw an error\n            throw new Error(\"No upload\");\n        },\n\n        /**\n         * Download a file from the app\n         *\n         * @param path - relative path to the file\n         * @param space - where to det it\n         */\n        download: async (\n            path: string | null,\n            space: Space = \"insight\",\n        ): Promise<boolean> => {\n            const id = this.getSpaceId(space);\n\n            const { pixelReturn } = await this.actions.run<[string]>(\n                `DownloadAsset(filePath=[\"${path}\"], space=[\"${id}\"]);`,\n                \"insight\",\n            );\n\n            // get the file key\n            const fileKey = pixelReturn[0].output;\n\n            try {\n                await download(this._store.insightId, fileKey);\n\n                return true;\n            } catch (error) {\n                this.processActionError(error as Error);\n            }\n\n            // throw an error\n            throw new Error(\"No download\");\n        },\n    };\n}\n"],"names":["Env","Object","defineProperty","get","this","_store","APP","MODULE","ACCESS_KEY","SECRET_KEY","update","updated","hasOwnProperty","_a","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","prototype","call","__extends","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","pop","push","__spreadArray","to","from","pack","ar","l","slice","concat","interceptors","request","response","path","options","method","fetch","json","data","post","isFormData","FormData","headers","keys","map","k","val","JSON","stringify","encodeURIComponent","join","UnauthorizedError","_super","message","AbstractError","_this","name","Error","CSRF","isEnabled","token","authorization","btoa","status","getSystemConfig","csrf","runPixel","pixel","insightId","expression","_b","errors","_i","pixelReturn","output","indexOf","insightID","runPixelAsync","postData","ok","errorData","errorMessage","jobId","error_1","getPixelAsyncResult","URLSearchParams","append","results","error_2","login","username","password","disableRedirect","oauth","provider","isPopup","window","top","url","popUpWindow","open","interval","setInterval","closed","undefined","clearInterval","document","location","href","host","close","response_1","logout","upload","files","projectId","param","fd","isArray","download","fileKey","link","createElement","target","appendChild","click","removeChild","partial","console","getPixelConsole","InsightStore","isInitialized","isAuthorized","isReady","error","system","appId","python","initialize","merged","app","type","detectScript","_d","loadScript","script","alias","env","parse","getElementById","_c","textContent","setupSystem","config","logins","setupInsight","warn","destroy","destroyInsight","destroySystem","key","availableProviders","processActionError","scriptEle","querySelector","content","getAttribute","text","e_1","actions","credentials","loggedIn","error_3","error_4","run","space","id","error_5","runPy","askModel","engineId","command","queryDatabase","databaseId","query","collect","error_6","getSpaceId","error_7"],"mappings":"AAGA,IAAAA,EAAA,WAAA,SAAAA,IA4DC,OAAD,OA9CIC,OAAAC,eAAWF,EAAG,MAAA,CAAdG,IAAA,WACI,OAAOC,KAAKC,OAAOC,GACtB,kCAKDL,OAAAC,eAAWF,EAAM,SAAA,CAAjBG,IAAA,WACI,OAAOC,KAAKC,OAAOE,MACtB,kCAKDN,OAAAC,eAAWF,EAAU,aAAA,CAArBG,IAAA,WACI,OAAOC,KAAKC,OAAOG,UACtB,kCAKDP,OAAAC,eAAWF,EAAU,aAAA,CAArBG,IAAA,WACI,OAAOC,KAAKC,OAAOI,UACtB,sCAjCcT,EAAAK,OAAS,CACpBC,IAAK,GACLC,OAAQ,GACRC,WAAY,GACZC,WAAY,IAmCTT,EAAMU,OAAG,SAACC,QAAA,IAAAA,IAAAA,EAA6C,CAAA,GACtDA,EAAQC,eAAe,SACvBC,EAAKR,OAAOC,IAAMK,EAAQL,KAG1BK,EAAQC,eAAe,YACvBC,EAAKR,OAAOE,OAASI,EAAQJ,QAG7BI,EAAQC,eAAe,gBACvBC,EAAKR,OAAOG,WAAaG,EAAQH,YAGjCG,EAAQC,eAAe,gBACvBC,EAAKR,OAAOI,WAAaE,EAAQF,WAEzC,EACHT,CAAA,IC/CGc,EAAgB,SAASC,EAAGC,GAI5B,OAHAF,EAAgBb,OAAOgB,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUJ,EAAGC,GAAKD,EAAEG,UAAYF,CAAE,GACzE,SAAUD,EAAGC,GAAK,IAAK,IAAII,KAAKJ,EAAOf,OAAOoB,UAAUT,eAAeU,KAAKN,EAAGI,KAAIL,EAAEK,GAAKJ,EAAEI,KACzFN,EAAcC,EAAGC,EAC5B,EAEO,SAASO,EAAUR,EAAGC,GACzB,GAAiB,mBAANA,GAA0B,OAANA,EAC3B,MAAM,IAAIQ,UAAU,uBAAyBC,OAAOT,GAAK,iCAE7D,SAASU,IAAOtB,KAAKuB,YAAcZ,CAAI,CADvCD,EAAcC,EAAGC,GAEjBD,EAAEM,UAAkB,OAANL,EAAaf,OAAO2B,OAAOZ,IAAMU,EAAGL,UAAYL,EAAEK,UAAW,IAAIK,EACnF,CAEU,IAACG,EAAW,WAQlB,OAPAA,EAAW5B,OAAO6B,QAAU,SAAkBC,GAC1C,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAIb,KADTY,EAAIG,UAAUF,GACOhC,OAAOoB,UAAUT,eAAeU,KAAKU,EAAGZ,KAAIW,EAAEX,GAAKY,EAAEZ,IAE9E,OAAOW,CACV,EACMF,EAASQ,MAAMjC,KAAM+B,UAChC,EA0EO,SAASG,EAAUC,EAASC,EAAYC,EAAGC,GAE9C,OAAO,IAAKD,IAAMA,EAAIE,WAAU,SAAUC,EAASC,GAC/C,SAASC,EAAUC,GAAS,IAAMC,EAAKN,EAAUO,KAAKF,GAAQ,CAAG,MAAOG,GAAKL,EAAOK,GAAO,CAC3F,SAASC,EAASJ,GAAS,IAAMC,EAAKN,EAAiB,MAAEK,GAAU,CAAC,MAAOG,GAAKL,EAAOK,GAAO,CAC9F,SAASF,EAAKI,GAJlB,IAAeL,EAIaK,EAAOC,KAAOT,EAAQQ,EAAOL,QAJ1CA,EAIyDK,EAAOL,MAJhDA,aAAiBN,EAAIM,EAAQ,IAAIN,GAAE,SAAUG,GAAWA,EAAQG,EAAO,KAIhBO,KAAKR,EAAWK,EAAY,CAC9GH,GAAMN,EAAYA,EAAUL,MAAME,EAASC,GAAc,KAAKS,OACtE,GACA,CAEO,SAASM,EAAYhB,EAASiB,GACjC,IAAsGC,EAAGC,EAAG3B,EAAG4B,EAA3GC,EAAI,CAAEC,MAAO,EAAGC,KAAM,WAAa,GAAW,EAAP/B,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,EAAK,EAAEgC,KAAM,GAAIC,IAAK,IAChG,OAAOL,EAAI,CAAEV,KAAMgB,EAAK,GAAIC,MAASD,EAAK,GAAIE,OAAUF,EAAK,IAAwB,mBAAXG,SAA0BT,EAAES,OAAOC,UAAY,WAAa,OAAOjE,IAAO,GAAGuD,EACvJ,SAASM,EAAK/B,GAAK,OAAO,SAAUoC,GAAK,OACzC,SAAcC,GACV,GAAId,EAAG,MAAM,IAAIjC,UAAU,mCAC3B,KAAOmC,IAAMA,EAAI,EAAGY,EAAG,KAAOX,EAAI,IAAKA,OACnC,GAAIH,EAAI,EAAGC,IAAM3B,EAAY,EAARwC,EAAG,GAASb,EAAU,OAAIa,EAAG,GAAKb,EAAS,SAAO3B,EAAI2B,EAAU,SAAM3B,EAAET,KAAKoC,GAAI,GAAKA,EAAET,SAAWlB,EAAIA,EAAET,KAAKoC,EAAGa,EAAG,KAAKlB,KAAM,OAAOtB,EAE3J,OADI2B,EAAI,EAAG3B,IAAGwC,EAAK,CAAS,EAARA,EAAG,GAAQxC,EAAEgB,QACzBwB,EAAG,IACP,KAAK,EAAG,KAAK,EAAGxC,EAAIwC,EAAI,MACxB,KAAK,EAAc,OAAXX,EAAEC,QAAgB,CAAEd,MAAOwB,EAAG,GAAIlB,MAAM,GAChD,KAAK,EAAGO,EAAEC,QAASH,EAAIa,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAKX,EAAEI,IAAIQ,MAAOZ,EAAEG,KAAKS,MAAO,SACxC,QACI,KAAMzC,EAAI6B,EAAEG,MAAMhC,EAAIA,EAAEK,OAAS,GAAKL,EAAEA,EAAEK,OAAS,KAAkB,IAAVmC,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAEX,EAAI,EAAG,QAAW,CAC5G,GAAc,IAAVW,EAAG,MAAcxC,GAAMwC,EAAG,GAAKxC,EAAE,IAAMwC,EAAG,GAAKxC,EAAE,IAAM,CAAE6B,EAAEC,MAAQU,EAAG,GAAI,KAAQ,CACtF,GAAc,IAAVA,EAAG,IAAYX,EAAEC,MAAQ9B,EAAE,GAAI,CAAE6B,EAAEC,MAAQ9B,EAAE,GAAIA,EAAIwC,EAAI,KAAQ,CACrE,GAAIxC,GAAK6B,EAAEC,MAAQ9B,EAAE,GAAI,CAAE6B,EAAEC,MAAQ9B,EAAE,GAAI6B,EAAEI,IAAIS,KAAKF,GAAK,KAAQ,CAC/DxC,EAAE,IAAI6B,EAAEI,IAAIQ,MAChBZ,EAAEG,KAAKS,MAAO,SAEtBD,EAAKf,EAAKlC,KAAKiB,EAASqB,EAC3B,CAAC,MAAOV,GAAKqB,EAAK,CAAC,EAAGrB,GAAIQ,EAAI,CAAE,CAAW,QAAED,EAAI1B,EAAI,CAAI,CAC1D,GAAY,EAARwC,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAExB,MAAOwB,EAAG,GAAKA,EAAG,QAAK,EAAQlB,MAAM,EAC7E,CAtB+CL,CAAK,CAACd,EAAGoC,GAAM,CAAG,CAuBtE,CA+DO,SAASI,EAAcC,EAAIC,EAAMC,GACpC,GAAIA,GAA6B,IAArB1C,UAAUC,OAAc,IAAK,IAA4B0C,EAAxB7C,EAAI,EAAG8C,EAAIH,EAAKxC,OAAYH,EAAI8C,EAAG9C,KACxE6C,GAAQ7C,KAAK2C,IACRE,IAAIA,EAAK3D,MAAME,UAAU2D,MAAM1D,KAAKsD,EAAM,EAAG3C,IAClD6C,EAAG7C,GAAK2C,EAAK3C,IAGrB,OAAO0C,EAAGM,OAAOH,GAAM3D,MAAME,UAAU2D,MAAM1D,KAAKsD,GACtD,CC5Na,IAAAM,EAGT,CACAC,QAAS,KACTC,SAAU,MAQDjF,EAAM,SAAUkF,EAAcC,eAAA,IAAAA,IAAAA,EAAyB,CAAA,uGAChEA,KACIC,OAAQ,OAELD,GAIHJ,EAAaC,QACH,CAAA,EAAMD,EAAaC,QAAQG,IADjB,CAAA,EAAA,UACpBA,EAAUzE,0BAIG,MAAM,CAAA,EAAA2E,MAAM,GAAGP,OAAAI,GAAQC,kBAAlCF,EAAWvE,EAA+BiD,OAG5CoB,EAAaE,SACP,CAAA,EAAAF,EAAaE,SAAS,CACxBA,SAAUA,KAFO,CAAA,EAAA,UACrBvE,EAAAiD,iBAMS,KAAA,EAAA,MAAA,CAAA,EAAMsB,EAASK,eAG5B,OAHMC,EAAO7E,EAAqBiD,OAG3B,CAAA,EAAA,CACHsB,SAAUA,EACVM,KAAMA,YAUDC,EAAO,SAChBN,EACA7B,EACA8B,eAAA,IAAAA,IAAAA,EAAyB,CAAA,2GAEnBM,EAAapC,aAAgBqC,SAG/BC,EAAuB,CAAA,EACvBR,EAAQQ,UACRA,EAAUR,EAAQQ,SAIjBF,IACAE,EAAmC,gBAChC,qCAGRR,EAAOzD,EAAA,CACH0D,OAAQ,OACRO,QAASA,EACTtC,KAAMoC,EACApC,EACAvD,OAAO8F,KAAKvC,GACPwC,KAAI,SAACC,GACF,IAAIC,EAAM1C,EAAKyC,GAKf,MAJmB,iBAARC,IACPA,EAAMC,KAAKC,UAAU5C,EAAKyC,KAGvB,GAAAhB,OAAGoB,mBAAmBJ,GAAM,KAAAhB,OAAAoB,mBAC/BH,GAER,IACCI,KAAK,MACbhB,GAIHJ,EAAaC,QACH,CAAA,EAAMD,EAAaC,QAAQG,IADjB,CAAA,EAAA,UACpBA,EAAUzE,0BAIG,MAAM,CAAA,EAAA2E,MAAM,GAAGP,OAAAI,GAAQC,kBAAlCF,EAAWvE,EAA+BiD,OAG5CoB,EAAaE,SACP,CAAA,EAAAF,EAAaE,SAAS,CACxBA,SAAUA,KAFO,CAAA,EAAA,UACrBvE,EAAAiD,iBAMS,KAAA,EAAA,MAAA,CAAA,EAAMsB,EAASK,eAG5B,OAHMC,EAAO7E,EAAqBiD,OAG3B,CAAA,EAAA,CACHsB,SAAUA,EACVM,KAAMA,YCnGda,EAAA,SAAAC,GACI,SAAAD,EAAYE,GACR,OAAAD,EAAAlF,KAAAlB,KAAMqG,IAAQrG,IACjB,CACL,OAJuCmB,EAAagF,EAAAC,GAInDD,CAAD,CAJA,CAVA,SAAAC,GACI,SAAAE,EAAYD,GAAZ,IACIE,EAAAH,EAAAlF,KAAAlB,KAAMqG,IAETrG,YADGuG,EAAKC,KAAOD,EAAKhF,YAAYiF,MAChC,CACL,OAL4BrF,EAAKmF,EAAAF,GAKhCE,CAAD,CALA,CAA4BG,QCAtBC,EAAO,CACTC,WAAW,EACXC,MAAO,IAIX9B,EAAaC,QAAU,SAAOG,GAAO,OAAAhD,OAAA,OAAA,OAAA,GAAA,0EAC7BtC,EAAIQ,YAAcR,EAAIS,aAEjB6E,EAAQQ,UACTR,EAAQQ,QAAU,IAItBR,EAAQQ,QAAOjE,EAAAA,EAAA,CAAA,EACRyD,EAAQQ,SACX,CAAAmB,cAAe,SAAAhC,OAASiC,KACpB,UAAGlH,EAAIQ,WAAU,KAAAyE,OAAIjF,EAAIS,iBAMjCqG,EAAKC,UACkB,SAAnBzB,EAAQC,OAAiB,CAAA,EAAA,GAEpBuB,EAAKE,MAAK,CAAA,EAAA,GACU,CAAA,EAAM7G,EACvB,GAAA8E,OAAGjF,EAAIO,gCACP,CACIuF,QAAS,CACL,eAAgB,YARtB,CAAA,EAAA,UAIEV,EAAavE,EAOpBiD,OAPesB,SAUhB0B,EAAKE,MACD5B,EAASU,QAAQ3F,IAAI,iBACrBiF,EAASU,QAAQ3F,IAAI,iBACrB,oBAIJmF,EAAQQ,UACRR,EAAQQ,QACDjE,EAAAA,EAAA,CAAA,EAAAyD,EAAQQ,SACX,CAAA,eAAgBgB,EAAKE,mBAMrC,KAAA,EAAA,MAAA,CAAA,EAAO1B,WAIXJ,EAAaE,SAAW,SAAOvE,GAAE,IAAAuE,EAAQvE,EAAAuE,8EACrC,GAAwB,MAApBA,EAAS+B,OACT,MAAM,IAAIZ,EAAkB,iCAOvB,IAAAa,EAAkB,WAAA,OAAA9E,OAAA,OAAA,OAAA,GAAA,qEAaV,MAAM,CAAA,EAAAnC,EAQpB,GAAG8E,OAAAjF,EAAIO,OAAM,wBAWhB,OAnBM6E,EAAWvE,EAQaiD,QAEjB4B,MAAQN,EAASM,KAAK2B,OACzBL,EAAQ5B,EAASM,KAAK,gBAG5BoB,EAAKC,WAAY,EACjBD,EAAKE,MAAQA,GAIV,CAAA,EAAA5B,EAASM,YAClB,EAQW4B,EAAW,SACpBC,EACAC,GAAkB,OAAAlF,OAAA,OAAA,OAAA,GAAA,+EAElB,IAAKiF,EACD,MAAM,IAAIV,MAAM,iBAWH,OARXrD,EAAgC,CAClCiE,WAAYF,GAGZC,IACAhE,EAAKgE,UAAYA,GAGJ,CAAA,EAAM7B,EAWpB,GAAGV,OAAAjF,EAAIO,OAA4B,wBAAEiD,EAAM,CAAA,WAI9C,IAfM4B,EAAWsC,EAWgC5D,OAG3C6D,EAAmB,GACgBC,EAAA,EAAzB/G,EAAAuE,EAASM,KAAKmC,YAAdD,EAAA/G,EAAAuB,OAAAwF,IAALxG,EAACP,EAAA+G,GACAE,EAA0B1G,EAApB0G,OAAoB1G,gBAEhB2G,QAAQ,UAAY,GAClCJ,EAAOlD,KAAKqD,GAIpB,MAAO,CAAA,EAAA,CACHH,OAAQA,EACRH,UAAWpC,EAASM,KAAKsC,UACzBH,YAAazC,EAASM,KAAKmC,oBAEjC,EAQWI,EAAgB,SAAOV,EAAeC,GAAkB,OAAAlF,OAAA,OAAA,OAAA,GAAA,2EACjE,IAAKiF,EACD,MAAMV,MAAM,uBAIZqB,EAAW,GAEfA,GAAY,cAAgB7B,mBAAmBkB,GAC3CC,IACAU,GAAY,cAAgB7B,mBAAmBmB,qBAI9B,6BAAA,CAAA,EAAMhC,MAAM,GAAAP,OAAGjF,EAAIO,oCAAmC,CACnEgF,OAAQ,OACRO,QAAS,CACL,eAAgB,qCAEpBtC,KAAM0E,YAGN,OARE9C,EAAWvE,EAMfiD,QAEYqE,GAAE,CAAA,EAAA,GACM,CAAA,EAAM/C,EAASK,eACjC,MADM2C,EAAYvH,EAAqBiD,OACjC+C,MAAMuB,EAAUC,cAAgB,uBAG7B,KAAA,EAAA,MAAA,CAAA,EAAMjD,EAASK,eAE5B,KAFMC,EAAO7E,EAAqBiD,QAG9B,MAAM+C,MAAM,qBAGhB,MAAO,CAAA,EAAA,CACHyB,MAAO5C,EAAK4C,eAGhB,0BAAqBzB,MACjB,MAAM0B,EAEV,MAAM1B,MAAM,oDAElB,EAMW2B,EAAsB,SAC/BF,GAAa,OAAAhG,OAAA,OAAA,OAAA,GAAA,qFAEb,IAAKgG,EACD,MAAMzB,MAAM,6CAGVrD,EAAO,IAAIiF,iBACZC,OAAO,QAASJ,oBAGA,6BAAA,CAAA,EAAM9C,MAAM,GAAAP,OAAGjF,EAAIO,6BAA4B,CAC5DgF,OAAQ,OACRO,QAAS,CACL,eAAgB,qCAEpBtC,KAAMA,YAGN,OARE4B,EAAWsC,EAMf5D,QAEYqE,GAAE,CAAA,EAAA,GACM,CAAA,EAAM/C,EAASK,eACjC,MADM2C,EAAYV,EAAqB5D,OACjC+C,MACFuB,EAAUC,cAAgB,gCAIpB,KAAA,EAAA,MAAA,CAAA,EAAMjD,EAASK,eAU7B,KAVMC,EAAQgC,EAAA5D,QAWV,MAAM+C,MAAM,qBAMhB,IAHMc,EAAmB,GAGOC,EAAA,EAAhB/G,EAAA6E,EAAKmC,YAALD,EAAA/G,EAAAuB,OAAAwF,IAALxG,EAACP,EAAA+G,GACAE,EAA0B1G,EAApB0G,OAAoB1G,gBAEhB2G,QAAQ,UAAY,GAClCJ,EAAOlD,KAAKqD,GAIpB,MAAO,CAAA,EAAA,CACHH,OAAQA,EACRH,UAAW9B,EAAKsC,UAChBW,QAASjD,EAAKmC,qBAGlB,0BAAqBhB,MACjB,MAAM+B,EAEV,MAAM/B,MAAM,oDAElB,EASWgC,EAAQ,SACjBC,EACAC,GAAgB,OAAAzG,OAAA,OAAA,OAAA,GAAA,sDAEhB,KAAA,EAAA,MAAA,CAAA,EAAMqD,EAAK,GAAAV,OAAGjF,EAAIO,0BAAyB,CACvCuI,SAAUA,EACVC,SAAUA,EACVC,iBAAiB,YAGrB,OANAnI,EAAAiD,OAMA,CAAA,GAAO,SACT,EASWmF,EAAQ,SACjBC,EACAC,eAAA,IAAAA,IAAAA,GAAe,8FAGE,MAAM,CAAA,EAAAhJ,EACnB,GAAA8E,OAAGjF,EAAIO,OAA4B,uBAAA0E,OAAAiE,YAIvC,IALM9D,EAAWvE,EAEhBiD,QAGY4B,MAAQN,EAASM,KAAKkB,KAC/B,MAAA,CAAA,GAAO,GAIX,GAAIuC,EACA,MAAM,IAAItC,MAAM,mBAGpB,MAAA,CAAA,EAAO,IAAIlE,SAAQ,SAACC,EAASC,GACzB,GAAKuG,QAAWA,OAAOC,IAKvB,IAAMC,EAAM,GAAGrE,OAAAjF,EAAIO,OAAM,oBAAA0E,OAAmBiE,GACtCK,EAAcH,OAAOC,IAAIG,KAC3BF,EACA,SACA,yCAIEG,EAAWC,aAAY,WAAA,OAAApH,OAAA,OAAA,OAAA,GAAA,mEAGjB,6BAACiH,IACDA,EAAYI,aACWC,IAAvBL,EAAYI,OAAoB,CAAA,EAAA,IAEhCE,cAAcJ,wBAEdF,EAAYO,SAASC,SAASC,KAAKjC,QAC/B,GAAA9C,OAAGmE,OAAOW,SAASE,QAClB,GAELJ,cAAcJ,GAGdF,EAAYW,QAGK,CAAA,EAAMjB,EAAMC,GAAU,KARjC,CAAA,EAAA,UAQAiB,EAAWtJ,EAA2BiD,OAG5ClB,EAAQuH,uFAMjB,UAxCCtH,EAAO,kBAyCd,aAQQuH,EAAS,WAAA,OAAA9H,OAAA,OAAA,OAAA,GAAA,6DAElB,MAAM,CAAA,EAAAnC,EAAI,GAAG8E,OAAAjF,EAAIO,OAAM,iCAEvB,OAFAM,EAAAiD,OAEA,CAAA,GAAO,SACT,EAUWuG,EAAS,SAClBC,EACA9C,EACA+C,EACAlF,GAAY,OAAA/C,OAAA,OAAA,OAAA,GAAA,yEAsCZ,GA/BIkI,EAAQ,GAEZnF,EAAOA,GAAQ,IACXmC,GAAa+C,GAAalF,KACtBmC,IACIgD,EAAMpI,OAAS,IACfoI,GAAS,KAEbA,GAAS,aAAAvF,OAAauC,IAGtB+C,IACIC,EAAMpI,OAAS,IACfoI,GAAS,KAEbA,GAAS,aAAAvF,OAAasF,IAGtBlF,IACImF,EAAMpI,OAAS,IACfoI,GAAS,KAEbA,GAAS,QAAAvF,OAAQI,IAGrBmF,EAAQ,IAAAvF,OAAIuF,IAGVlB,EAAM,UAAGtJ,EAAIO,OAAmC,8BAAA0E,OAAAuF,GAEhDC,EAAe,IAAI5E,SACrB1E,MAAMuJ,QAAQJ,GACd,IAASrI,EAAI,EAAGA,EAAIqI,EAAMlI,OAAQH,IAC9BwI,EAAG/B,OAAO,OAAQ4B,EAAMrI,SAI5BwI,EAAG/B,OAAO,OAAQ4B,GAGL,MAAM,CAAA,EAAA3E,EAKrB2D,EAAKmB,EAAI,CAAE,WAEb,MAAO,CAAA,EAPU5J,EAKHiD,OAEE4B,YAClB,EAQWiF,EAAW,SAAOnD,EAAmBoD,GAAe,OAAAtI,OAAA,OAAA,OAAA,GAAA,sCAC7D,MAAA,CAAA,EAAO,IAAIK,SAAc,SAACC,GACtB,IAAK4E,EACD,MAAMX,MAAM,wCAGhB,IAAMyC,EAAM,GACRrE,OAAAjF,EAAIO,OAAM,uCAAA0E,OACwBuC,EAAS,aAAAvC,OAAYoB,mBACvDuE,IAIEC,EAA0Bf,SAASgB,cAAc,KAEvDD,EAAKb,KAAOV,EACZuB,EAAKE,OAAS,SACdjB,SAAStG,KAAKwH,YAAYH,GAC1BA,EAAKI,QAELnB,SAAStG,KAAK0H,YAAYL,GAG1BjI,GACH,UACH,EAMWuI,EAAU,SAAO3D,GAAiB,OAAAlF,OAAA,OAAA,OAAA,GAAA,sDAC1B,KAAA,EAAA,MAAA,CAAA,EAAMqD,EAMpB,GAAAV,OAAGjF,EAAIO,8BAA6B,CACnC+H,MAAOd,YAGX,MAAO,CAAA,EAVU3G,EAQfiD,OAEc4B,YAClB,EAMW0F,EAAU,SAAO5D,GAAiB,OAAAlF,OAAA,OAAA,OAAA,GAAA,sDAC1B,KAAA,EAAA,MAAA,CAAA,EAAMqD,EAGpB,GAAAV,OAAGjF,EAAIO,8BAA6B,CACnC+H,MAAOd,YAGX,MAAO,CAAA,EAPU3G,EAKfiD,OAEc4B,YAClB,EAMW2F,EAAkB,SAAO7D,GAAiB,OAAAlF,OAAA,OAAA,OAAA,GAAA,sDAClC,KAAA,EAAA,MAAA,CAAA,EAAMqD,EAGpB,GAAAV,OAAGjF,EAAIO,8BAA6B,CACnC+H,MAAOd,YAGX,MAAO,CAAA,EAPU3G,EAKfiD,OAEc4B,cCrdpB4F,EAAA,WAAA,SAAAA,IAAA,IAqrBC3E,EAAAvG,KAprBWA,KAAAC,OAAgC,CACpCmH,UAAW,GACX+D,eAAe,EACfC,cAAc,EACdC,SAAS,EACTC,MAAO,KACPC,OAAQ,KACRrG,QAAS,CACLsG,MAAO,GACPC,OAAQ,OAmDhBzL,KAAU0L,WAAG,SAAOxG,GAwBnB,OAAAhD,EAAAqE,OAAA,OAAA,GAAA,oFAEGvG,KAAKC,OAAOkL,eAAgB,EAC5BnL,KAAKC,OAAOmL,cAAe,EAC3BpL,KAAKC,OAAOoL,SAAU,EAEhBM,EAAsC,CACxCC,IAAK1G,GAAWA,EAAQ0G,IAAM1G,EAAQ0G,IAAM,GAC5CH,OACIvG,QAAqC,IAAnBA,EAAQuG,OACpBvG,EAAQuG,OACR,CACII,KAAM,WAKxB7L,KAAKC,OAAOiF,QAAQsG,MAAQ,GACxBG,EAAOC,MACP5L,KAAKC,OAAOiF,QAAQsG,MAAQG,EAAOC,KAIvC5L,KAAKC,OAAOiF,QAAQuG,OAAS,KACzBE,EAAOF,OACoB,WAAvBE,EAAOF,OAAOI,KAAiB,CAAA,EAAA,IAC/BpL,EAAAT,KAAKC,OAAOiF,QAAiB,CAAA,EAAMlF,KAAK8L,iBAF/B,CAAA,EAAA,iBAETrL,EAAoBgL,OAASM,EAAArI,0BACC,SAAvBiI,EAAOF,OAAOI,KAAe,CAAA,EAAA,IACpCvE,EAAAtH,KAAKC,OAAOiF,QAAuB,CAAA,EAAAlF,KAAKgM,WACpCL,EAAOF,wBADXnE,EAAoBmE,OAASM,EAAArI,oBAGC,WAAvBiI,EAAOF,OAAOI,OACrB7L,KAAKC,OAAOiF,QAAQuG,OAAS,CACzBQ,OAAQN,EAAOF,OAAOQ,OACtBC,MAAOP,EAAOF,OAAOS,yBAMjC,IACI,IAAKxC,SACD,MAAO,CAAA,IAGLyC,EAAMpG,KAAKqG,OACwB,UAArC1C,SAAS2C,eAAe,qBAAa,IAAAC,OAAA,EAAAA,EAAEC,cAAe,MAQtD3M,EAAIU,OAAO,CACPJ,IAAKiM,EAAIjM,IACTC,OAAQgM,EAAIhM,QAGvB,CAAC,MAAO2C,GAER,kBASG,2BALIlD,EAAIM,MACJF,KAAKC,OAAOiF,QAAQsG,MAAQ5L,EAAIM,MAI/BN,EAAIO,OACL,MAAM,IAAIsG,MAAM,sBAIpB,MAAA,CAAA,EAAMzG,KAAKwM,sBAGX,GAHAT,EAAArI,QAGK1D,KAAKC,OAAOkL,cACb,MAAM,IAAI1E,MAAM,wBAKhB,OAACzG,KAAKC,OAAOsL,QACT1L,OAAO8F,KAAK3F,KAAKC,OAAOsL,OAAOkB,OAAOC,QAAQ1K,OAAS,GAC1DpC,EAAIQ,YAAcR,EAAIS,YAGvBL,KAAKC,OAAOmL,cAAe,EAG3B,CAAA,EAAMpL,KAAK2M,iBANuB,CAAA,EAAA,iBAMlCZ,EAAArI,qBAGA1D,KAAKC,OAAOmL,cAAe,4DAI/BJ,QAAQ4B,KAAKzE,GAGbnI,KAAKC,OAAOqL,MAAQnD,mCAO5BnI,KAAA6M,QAAU,WAAA,OAAA3K,EAAAqE,OAAA,OAAA,GAAA,mEAGF,8BAAA,CAAA,EAAMvG,KAAK8M,gCAAXrM,EAAAiD,OAGA1D,KAAK+M,+CAGL/B,QAAQ4B,KAAKpE,GAGbxI,KAAKC,OAAOqL,MAAQ9C,sBAGpBxI,KAAKC,OAAOkL,eAAgB,EAC5BnL,KAAKC,OAAOmL,cAAe,EAC3BpL,KAAKC,OAAOoL,SAAU,+BAQtBrL,KAAAwM,YAAc,WAAA,OAAAtK,EAAAqE,OAAA,OAAA,GAAA,uEAKL,OAHbvG,KAAKC,OAAOkL,eAAgB,EAGT,CAAA,EAAAnE,YAGnB,GAHM1B,EAAO7E,EAAuBiD,OAEhC6H,EAA0C,KAC1CjG,EAUA,IAAW0H,KARXzB,EAAS,CACLkB,OAAQ,CACJC,OAAQ,CAAE,EACVO,mBAAoB,KAKV3H,EACdiG,EAAOkB,OAAOO,GAAO1H,EAAK0H,UAIlChN,KAAKC,OAAOsL,OAASA,EACjBvL,KAAKC,OAAOsL,OACZvL,KAAKC,OAAOkL,eAAgB,EAE5BnL,KAAKC,OAAOkL,eAAgB,cAO5BnL,KAAA+M,cAAgB,WAEpBxG,EAAKtG,OAAOsL,OAAS,IACzB,EAKQvL,KAAA2M,aAAe,WAAA,OAAAzK,EAAAqE,OAAA,OAAA,GAAA,2EA+BW,OA7B9BvG,KAAKC,OAAOoL,SAAU,EAGlBlE,EAAQ,GACRnH,KAAKC,OAAOiF,QAAQsG,QACpBrE,GAAS,eAAetC,OAAA7E,KAAKC,OAAOiF,QAAQsG,MAAK,QAIjDxL,KAAKC,OAAOiF,QAAQuG,QAAUzL,KAAKC,OAAOiF,QAAQuG,OAAOQ,UAErDC,EAAQlM,KAAKC,OAAOiF,QAAQuG,OAAOS,SAEnCA,EAAQ,OACRlB,QAAQ4B,KAAK,6CAAsCV,KAGvD/E,GAAS,8BAAAtC,OACM7E,KAAKC,OAAOiF,QAAQuG,OAAOQ,OAC9B,qDAAApH,OAAAqH,gDAKX/E,IACDA,EAAQ,QAIkB,CAAA,EAAMD,EAChCC,EACA,eAIJ,GANM1G,EAAwB6G,SAAtBF,EAAS3G,EAAA2G,WAAEG,EAAM9G,EAAA8G,QAMdvF,OACP,MAAM,IAAIyE,MAAMc,EAAO,WAI3BvH,KAAKC,OAAOmH,UAAYA,EAGxBpH,KAAKC,OAAOoL,SAAU,cAMlBrL,KAAA8M,eAAiB,WAAA,OAAA5K,EAAAqE,OAAA,OAAA,GAAA,mEACrB,OAAKvG,KAAKC,OAAOmH,UAIQ,CAAA,EAAAF,EACrB,gBACAlH,KAAKC,OAAOmH,YALL,CAAA,UASX,IANQG,EAAW9G,EAGlBiD,OAHa6D,QAMHvF,OACP,MAAM,IAAIyE,MAAMc,EAAO,WAI3BvH,KAAKC,OAAOmH,UAAY,eAOpBpH,KAAkBkN,mBAAG,SAAC5B,GAE1B,KAAIA,aAAiBnF,GAMrB,MAAMmF,EALF/E,EAAKtG,OAAOmL,cAAe,CAMnC,EAKQpL,KAAA8L,aAAe,WAAA,OAAA5J,EAAAqE,OAAA,OAAA,GAAA,gDACbmB,EAAS,CACXuE,OAAQ,GACRC,MAAO,IAGX,IAGI,GAFMiB,EAAYzD,SAAS0D,cAAc,sBACnCC,EAAUF,eAAAA,EAAWZ,aAEvB,MAAA,CAAA,EAAO,MAIX7E,EAAOuE,OAASoB,EAGhB3F,EAAOwE,OAAQiB,aAAS,EAATA,EAAWG,aAAa,gBAAiB,EAC3D,CAAC,MAAOxK,GAEL,OADAkI,QAAQ4B,KAAK9J,GACb,CAAA,EAAO,KACV,CAED,MAAA,CAAA,EAAO4E,UAMH1H,KAAUgM,WAAG,SAAOS,GAG3B,OAAAvK,EAAAqE,OAAA,OAAA,GAAA,uEACSmB,EAAS,CACXuE,OAAQ,GACRC,MAAOO,EAAOP,wBAIG,6BAAA,CAAA,EAAM9G,MAAMqH,EAAOxH,cAEvB,MAAA,CAAA,EAFIxE,EAAwBiD,OAEb6J,eAC5B,KADMA,EAAO9M,EAAqBiD,QAE9B,MAAM,IAAI+C,MAAM,kBAIpBiB,EAAOuE,OAASsB,eAKhB,kBAHAvC,QAAQ4B,KAAKY,GAGb,CAAA,EAAO,MAGX,KAAA,EAAA,MAAA,CAAA,EAAO9F,WA0BX1H,KAAAyN,QAAU,CAMNhF,MAAO,SACHiF,GASO,OAAAxL,EAAAqE,OAAA,OAAA,GAAA,qEAKC,6BADAoH,GAAW,EACU,WAArBD,EAAY7B,KAAiB,CAAA,EAAA,GACN,CAAA,EAAApD,EACnBiF,EAAYhF,SACZgF,EAAY/E,yBAFClI,EAGhBiD,SAGGiK,GAAW,gBAER,MAAqB,UAArBD,EAAY7B,KAAgB,CAAA,EAAA,GAClB,CAAA,EAAMhD,EAAM6E,EAAY5E,kBAAxBrI,EAAiCiD,SAE9CiK,GAAW,oBAIf,OAAAA,GAEA3N,KAAKC,OAAOmL,cAAe,EAG3B,CAAA,EAAMpL,KAAK2M,iBALH,CAAA,EAAA,iBAKRlM,EAAAiD,oBAGA1D,KAAKC,OAAOmL,cAAe,mBAI/B,MAAA,CAAA,EAAOuC,4BAEP3N,KAAKkN,mBAAmBU,SAG5B,KAAA,EAAA,MAAA,CAAA,GAAO,MACV,GAAA,EAKD5D,OAAQ,WAAA,OAAA9H,EAAAqE,OAAA,OAAA,GAAA,mEAEiB,6BAAM,CAAA,EAAAyD,YACvB,OADiBvJ,EAAciD,OAM/B,CAAA,GAAO,GAJH,CAAA,GAAO,4BAMX1D,KAAKkN,mBAAmBW,SAG5B,KAAA,EAAA,MAAA,CAAA,GAAO,MACV,GAAA,EAODC,IAAK,SACD3G,EACA4G,eAAA,IAAAA,IAAAA,EAAwB,yGAIpB,yBADIC,EAAK,GACK,YAAVD,EACAC,EAAKhO,KAAKC,OAAOmH,eACd,GAAc,QAAV2G,EAAiB,CACxB,IAAK/N,KAAKC,OAAOiF,QAAQsG,MACrB,MAAM,IAAI/E,MACN,8CAKRuH,EAAKhO,KAAKC,OAAOiF,QAAQsG,KAC5B,CAE+B,MAAA,CAAA,EAAMtE,EAAYC,EAAO6G,WAEzD,GAFMvN,EAA0B6G,SAAxBC,EAAM9G,EAAA8G,OAAEE,EAAWhH,EAAAgH,YAEvBF,EAAOvF,OACP,MAAM,IAAIyE,MAAMc,EAAOrB,KAAK,KAGhC,MAAA,CAAA,EAAO,CAAEuB,YAAWA,6BAEpBzH,KAAKkN,mBAAmBe,gBAI5B,MAAM,IAAIxH,MAAM,qBACnB,EAODyH,MAAO,SAAUzC,EAAgBsC,eAAA,IAAAA,IAAAA,EAAwB,oFAC7B,KAAA,EAAA,MAAA,CAAA,EAAM/N,KAAKyN,QAAQK,IAQzC,eAAejJ,OAAA4G,EAAmB,eAAEsC,WAEtC,MAAO,CAAA,EAAA,CACHrG,OAXoBjH,EAQoBiD,OARzB+D,YAWK,GAAGC,OAAO,GAAGA,eAExC,EAQDyG,SAAU,SACNC,EACAC,EACAN,eAAA,IAAAA,IAAAA,EAAwB,oFAEA,KAAA,EAAA,MAAA,CAAA,EAAM/N,KAAKyN,QAAQK,IAGvC,gBAAAjJ,OAAgBuJ,EAAQ,0BAAAvJ,OAAyBwJ,EAAO,iBACxDN,WAGJ,MAAO,CAAA,EAAA,CACHrG,OARoBjH,EAKvBiD,OALkB+D,YAQK,GAAGC,eAE9B,EASD4G,cAAe,SACXC,EACAC,EACAtJ,EAKA6I,eALA,IAAA7I,IAAAA,EAAA,CAGIuJ,SAAU,SAEd,IAAAV,IAAAA,EAAwB,oFAEA,KAAA,EAAA,MAAA,CAAA,EAAM/N,KAAKyN,QAAQK,IAUvC,uBAAAjJ,OAAuB0J,EAAU,yBAAA1J,OAAwB2J,EAAK,0BAAA3J,OAC/B,iBAApBK,EAAQuJ,QAAuBvJ,EAAQuJ,SAAW,EAAC,OAE9DV,WAGJ,MAAO,CAAA,EAAA,CACHrG,OAjBoBjH,EAcvBiD,OAdkB+D,YAiBK,GAAGC,eAE9B,EASDuC,OAAQ,SACJC,EACAjF,EACA8I,eAAA,IAAAA,IAAAA,EAAwB,iGAQH,6BAAA,CAAA,EAAM9D,EACnBC,EACAlK,KAAKC,OAAOmH,UACF,QAAV2G,EAAkB/N,KAAKC,OAAOiF,QAAQsG,MAAQ,GAC9CvG,WAGJ,MAAA,CAAA,EAPiBxE,EAKhBiD,iCAID1D,KAAKkN,mBAAmBwB,gBAI5B,MAAM,IAAIjI,MAAM,mBACnB,EAQD8D,SAAU,SACNtF,EACA8I,eAAA,IAAAA,IAAAA,EAAwB,uGAIA,OAFlBC,EAAKhO,KAAK2O,WAAWZ,GAEH,CAAA,EAAM/N,KAAKyN,QAAQK,IACvC,4BAAAjJ,OAA4BI,EAAI,gBAAAJ,OAAemJ,EAAE,QACjD,mBAFIvG,EAAgBhH,EAGvBiD,OAHkB+D,YAMb+C,EAAU/C,EAAY,GAAGC,wBAG3B,6BAAM,CAAA,EAAA6C,EAASvK,KAAKC,OAAOmH,UAAWoD,WAEtC,OAFA/J,EAAAiD,OAEA,CAAA,GAAO,4BAEP1D,KAAKkN,mBAAmB0B,gBAI5B,MAAM,IAAInI,MAAM,qBACnB,EAER,CAAD,OAnqBI5G,OAAAC,eAAIoL,EAASjK,UAAA,YAAA,CAAblB,IAAA,WACI,OAAOC,KAAKC,OAAOmH,SACtB,kCAIDvH,OAAAC,eAAIoL,EAAajK,UAAA,gBAAA,CAAjBlB,IAAA,WACI,OAAOC,KAAKC,OAAOkL,aACtB,kCAKDtL,OAAAC,eAAIoL,EAAYjK,UAAA,eAAA,CAAhBlB,IAAA,WACI,OAAOC,KAAKC,OAAOmL,YACtB,kCAKDvL,OAAAC,eAAIoL,EAAOjK,UAAA,UAAA,CAAXlB,IAAA,WACI,OAAOC,KAAKC,OAAOoL,OACtB,kCAIDxL,OAAAC,eAAIoL,EAAKjK,UAAA,QAAA,CAATlB,IAAA,WACI,OAAOC,KAAKC,OAAOqL,KACtB,kCAKDzL,OAAAC,eAAIoL,EAAMjK,UAAA,SAAA,CAAVlB,IAAA,WACI,OAAOC,KAAKC,OAAOsL,MACtB,kCAuWOL,EAAUjK,UAAA0N,WAAlB,SAAmBZ,GACf,IAAIC,EAAK,GACT,GAAc,YAAVD,EACAC,EAAKhO,KAAKC,OAAOmH,eACd,GAAc,QAAV2G,EAAiB,CACxB,IAAK/N,KAAKC,OAAOiF,QAAQsG,MACrB,MAAM,IAAI/E,MAAM,8CAIpBuH,EAAKhO,KAAKC,OAAOiF,QAAQsG,KAC5B,CAED,OAAOwC,GA4Qd9C,CAAD"}